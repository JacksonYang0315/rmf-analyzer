<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RMF Workload Activity Analyzer</title>

  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <!-- DataTables Bootstrap 5 -->
  <link href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css" rel="stylesheet">

  <style>
    :root {
      --grad-start: #4e54c8;
      --grad-end:   #8f94fb;
    }

    body {
      background: linear-gradient(135deg, var(--grad-start) 0%, var(--grad-end) 100%);
      background-attachment: fixed;
      min-height: 100vh;
      font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
    }

    /* --- Navbar --- */
    .navbar {
      background: rgba(30, 30, 60, .85) !important;
      backdrop-filter: blur(12px);
      border-bottom: 1px solid rgba(255,255,255,.08);
    }
    .navbar-brand { font-weight: 700; letter-spacing: .5px; }

    /* --- Glass cards --- */
    .glass {
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(16px);
      border: 1px solid rgba(255,255,255,.25);
      border-radius: 16px;
      box-shadow: 0 4px 24px rgba(0,0,0,.08);
      transition: transform .2s, box-shadow .2s;
    }
    .glass:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 32px rgba(0,0,0,.14);
    }

    /* --- Stat cards row --- */
    .stat-card {
      border-radius: 14px;
      padding: 1.1rem 1.4rem;
      color: #fff;
      position: relative;
      overflow: hidden;
    }
    .stat-card::after {
      content: '';
      position: absolute;
      top: -30%; right: -20%;
      width: 120px; height: 120px;
      border-radius: 50%;
      background: rgba(255,255,255,.12);
    }
    .stat-card .stat-value { font-size: 1.8rem; font-weight: 700; }
    .stat-card .stat-label { font-size: .82rem; opacity: .85; text-transform: uppercase; letter-spacing: .5px; }
    .bg-grad-1 { background: linear-gradient(135deg, #667eea, #764ba2); }
    .bg-grad-2 { background: linear-gradient(135deg, #f093fb, #f5576c); }
    .bg-grad-3 { background: linear-gradient(135deg, #4facfe, #00f2fe); }
    .bg-grad-4 { background: linear-gradient(135deg, #43e97b, #38f9d7); }

    /* --- Filter sidebar --- */
    .filter-section .form-label { font-weight: 600; font-size: .85rem; color: #555; }
    .filter-section .form-select,
    .filter-section .form-control { border-radius: 10px; font-size: .9rem; }

    /* --- Buttons --- */
    .btn-apply {
      background: linear-gradient(90deg, var(--grad-start), var(--grad-end));
      color: #fff; border: none; border-radius: 10px; font-weight: 600;
    }
    .btn-apply:hover { opacity: .9; color: #fff; }
    .btn-export {
      background: linear-gradient(90deg, #43e97b, #38f9d7);
      color: #1a1a2e; border: none; border-radius: 10px; font-weight: 600;
    }
    .btn-export:hover { opacity: .9; color: #1a1a2e; }

    /* --- Chart container --- */
    .chart-wrap { position: relative; height: 380px; }

    /* --- Table tweaks --- */
    .table thead th {
      background: #f8f9fc;
      font-size: .82rem;
      text-transform: uppercase;
      letter-spacing: .4px;
      border-bottom: 2px solid var(--grad-start);
    }
    .table tbody td { font-size: .88rem; }

    /* --- Loading overlay --- */
    #loadingOverlay {
      position: fixed; inset: 0;
      background: rgba(30,30,60,.7);
      backdrop-filter: blur(6px);
      display: flex; align-items: center; justify-content: center;
      z-index: 9999; transition: opacity .4s;
    }
    #loadingOverlay.hidden { opacity: 0; pointer-events: none; }
    .loader {
      width: 56px; height: 56px;
      border: 5px solid rgba(255,255,255,.25);
      border-top-color: #fff;
      border-radius: 50%;
      animation: spin .8s linear infinite;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* Responsive */
    @media (max-width: 991px) {
      .stat-card .stat-value { font-size: 1.4rem; }
      .chart-wrap { height: 280px; }
    }
  </style>
</head>
<body>

<!-- Loading -->
<div id="loadingOverlay">
  <div class="text-center text-white">
    <div class="loader mb-3 mx-auto"></div>
    <div class="fw-semibold">Parsing RMF Reports&hellip;</div>
  </div>
</div>

<!-- Navbar -->
<nav class="navbar navbar-dark shadow-sm px-3">
  <span class="navbar-brand">
    <i class="bi bi-cpu me-2"></i>z/OS RMF Workload Analyzer
  </span>
  <span class="badge bg-light text-dark fs-6" id="headerBadge">--</span>
</nav>

<!-- Main content -->
<div class="container-fluid py-4 px-lg-4">

  <!-- Stat cards -->
  <div class="row g-3 mb-4" id="statRow">
    <div class="col-6 col-lg-3">
      <div class="stat-card bg-grad-1">
        <div class="stat-value" id="statRecords">--</div>
        <div class="stat-label">Total Records</div>
      </div>
    </div>
    <div class="col-6 col-lg-3">
      <div class="stat-card bg-grad-2">
        <div class="stat-value" id="statFiltered">--</div>
        <div class="stat-label">Filtered</div>
      </div>
    </div>
    <div class="col-6 col-lg-3">
      <div class="stat-card bg-grad-3">
        <div class="stat-value" id="statFiles">--</div>
        <div class="stat-label">Files Parsed</div>
      </div>
    </div>
    <div class="col-6 col-lg-3">
      <div class="stat-card bg-grad-4">
        <div class="stat-value" id="statClasses">--</div>
        <div class="stat-label">Service Classes</div>
      </div>
    </div>
  </div>

  <div class="row g-4">
    <!-- Sidebar -->
    <div class="col-lg-3">
      <div class="glass p-3 filter-section">
        <h6 class="mb-3"><i class="bi bi-funnel me-1"></i> Filters</h6>

        <div class="mb-3">
          <label class="form-label">Source File</label>
          <select id="filterSource" class="form-select form-select-sm">
            <option value="">All Files</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Workload</label>
          <select id="filterWorkload" class="form-select form-select-sm">
            <option value="">All Workloads</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Service Class</label>
          <select id="filterSvcClass" class="form-select form-select-sm">
            <option value="">All Classes</option>
          </select>
        </div>
        <div class="mb-3">
          <label class="form-label">Start Date/Time</label>
          <input type="datetime-local" id="filterStart" class="form-control form-control-sm">
        </div>
        <div class="mb-3">
          <label class="form-label">End Date/Time</label>
          <input type="datetime-local" id="filterEnd" class="form-control form-control-sm">
        </div>

        <div class="d-grid gap-2">
          <button class="btn btn-apply btn-sm" id="btnApply">
            <i class="bi bi-search me-1"></i>Apply
          </button>
          <button class="btn btn-outline-secondary btn-sm" id="btnReset">
            <i class="bi bi-arrow-counterclockwise me-1"></i>Reset
          </button>
          <button class="btn btn-export btn-sm" id="btnExport">
            <i class="bi bi-download me-1"></i>Export CSV
          </button>
        </div>
      </div>
    </div>

    <!-- Main area -->
    <div class="col-lg-9">
      <!-- Chart -->
      <div class="glass p-3 mb-4">
        <h6 class="mb-2"><i class="bi bi-graph-up me-1"></i> APPL % CP Trend by Service Class</h6>
        <div class="chart-wrap">
          <canvas id="cpuChart"></canvas>
        </div>
      </div>

      <!-- Table -->
      <div class="glass p-3">
        <h6 class="mb-3"><i class="bi bi-table me-1"></i> Detailed Records</h6>
        <div class="table-responsive">
          <table id="dataTable" class="table table-striped table-hover align-middle w-100">
            <thead>
              <tr>
                <th>Date-Time</th>
                <th>Service Class</th>
                <th>Workload</th>
                <th>Period</th>
                <th>APPL % CP</th>
                <th>Source</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- JS libs -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0/dist/chartjs-adapter-date-fns.bundle.min.js"></script>

<!-- App JS -->
<script src="/static/js/app.js"></script>
</body>
</html>
